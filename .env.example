# ============================================
# Mini-NVR Configuration
# Copy this file to .env and update values
# ============================================

# DVR Connection
DVR_IP=192.168.1.100
DVR_USER=admin
DVR_PASS=changeme
DVR_PORT=554

# RTSP URL Template
# Placeholders: {user}, {pass}, {ip}, {port}, {channel}
# Hikvision: rtsp://{user}:{pass}@{ip}:{port}/Streaming/Channels/{channel}01
# Dahua:     rtsp://{user}:{pass}@{ip}:{port}/cam/realmonitor?channel={channel}&subtype=0
RTSP_URL_TEMPLATE=rtsp://{user}:{pass}@{ip}:{port}/Streaming/Channels/{channel}01

# Recording Settings
NUM_CHANNELS=8
RECORD_DIR=/recordings
SEGMENT_DURATION=600

# Storage Management
# When exceeded, cleanup will delete 50% of oldest files
MAX_STORAGE_GB=500
CLEANUP_INTERVAL=300

# Web Server Port
WEB_PORT=2126

# Video Compression Settings
# VIDEO_CODEC: "copy" for no re-encoding (fast), or "libx264" for H.264 encoding
# VIDEO_CRF: Quality (0-51, lower = better quality, 23 is default)
# VIDEO_PRESET: Encoding speed (ultrafast, superfast, veryfast, faster, fast, medium, slow, slower, veryslow)
VIDEO_CODEC=copy
VIDEO_CRF=23
VIDEO_PRESET=veryfast

# Logging
# Set LOG_FILE to enable file logging (in addition to stdout)
# Leave empty or remove to log only to stdout
LOG_FILE=/logs/app.log

# ============================================
# Security Configuration
# ============================================

# SECRET_KEY is required for session security
# Generate with: python -c "import secrets; print(secrets.token_hex(32))"
SECRET_KEY=your-secure-random-key-here

# User Authentication
# Add users as user1/pass1, user2/pass2, etc.
# For production, use bcrypt hashed passwords:
#   python -c "import bcrypt; print(bcrypt.hashpw(b'yourpassword', bcrypt.gensalt()).decode())"
user1=admin
pass1=changeme

# ============================================
# go2rtc Live Streaming (WebRTC)
# ============================================

# Timezone for go2rtc container
TZ=Asia/Kolkata

# go2rtc ports (optional, defaults shown)
GO2RTC_API_PORT=2127
GO2RTC_WEBRTC_PORT=8555
GO2RTC_RTSP_PORT=8554

# go2rtc.yaml is AUTO-GENERATED from this .env file
# Run: ./scripts/generate-go2rtc-config.sh

# ============================================
# YouTube Live Streaming (via go2rtc)
# ============================================
# Each channel gets its own stream key (1:1 mapping)
# Stream restarts hourly to create separate YouTube videos for easy archiving
# Create keys at: YouTube Studio -> Create -> Go Live -> Stream

YOUTUBE_ENABLED=false
YOUTUBE_RTMP_URL=rtmp://a.rtmp.youtube.com/live2
YOUTUBE_ROTATION_MINUTES=60

# Stream keys: one per channel (only configure the channels you want to stream)
# Get keys from: YouTube Studio -> Create -> Go Live -> Stream settings
YOUTUBE_STREAM_KEY_1=
YOUTUBE_STREAM_KEY_2=
YOUTUBE_STREAM_KEY_3=
YOUTUBE_STREAM_KEY_4=
YOUTUBE_STREAM_KEY_5=
YOUTUBE_STREAM_KEY_6=
YOUTUBE_STREAM_KEY_7=
YOUTUBE_STREAM_KEY_8=

# ============================================
# YouTube Video Upload (Recorded Videos)
# ============================================
# Upload converted MP4 recordings to YouTube automatically
# Requires: client_secret.json from Google Cloud Console

YOUTUBE_UPLOAD_ENABLED=false
YOUTUBE_CLIENT_SECRET_PATH=./ytktclient_secret.json
YOUTUBE_TOKEN_PATH=./ytkttoken.json
YOUTUBE_ENCRYPT_PATH=./encrypt
YOUTUBE_VIDEO_PRIVACY=private
YOUTUBE_DELETE_AFTER_UPLOAD=false
YOUTUBE_UPLOAD_INTERVAL=60

# Optional: HuggingFace Hub for encrypted token storage
# HF_REPO_ID=username/my-tokens

# Required Environment Variables (if using HF storage):
# HF_TOKEN=hf_your_huggingface_token
# YT_ENCRYP_KEY=your-fernet-encryption-key
