# ============================================
# Mini-NVR Configuration
# Copy this file to .env and update values
# ============================================

# DVR Connection
DVR_IP=192.168.18.41
DVR_USER=changeme
DVR_PASS=changeme
DVR_PORT=554

# RTSP URL Template
# Placeholders: {user}, {pass}, {ip}, {port}, {channel}
# Hikvision: rtsp://{user}:{pass}@{ip}:{port}/Streaming/Channels/{channel}01
# Dahua:     rtsp://{user}:{pass}@{ip}:{port}/cam/realmonitor?channel={channel}&subtype=0
RTSP_URL_TEMPLATE=rtsp://{user}:{pass}@{ip}:{port}/Streaming/Channels/{channel}01

# Recording Settings
NUM_CHANNELS=8
SKIP_CHANNELS=6,
RECORD_DIR=./recordings
SEGMENT_DURATION=10

# Storage Management
# When exceeded, cleanup will delete 10% of oldest files
MAX_STORAGE_GB=50
CLEANUP_INTERVAL=30

# ============================================
# Backup Service
# ============================================
# Copy recordings to external backup location
# Runs inside Docker, syncs every BACKUP_SYNC_INTERVAL seconds

BACKUP_ENABLED=false
BACKUP_DIR=/backup
BACKUP_MAX_STORAGE_GB=400
BACKUP_SYNC_INTERVAL=7200

# Web Server Port
WEB_PORT=2126

# Video Compression Settings
INLINE_TRANSCODING=true
FFMPEG_HW_ARGS="-init_hw_device vaapi=va:/dev/dri/renderD128 -hwaccel vaapi -hwaccel_output_format vaapi"
FFMPEG_VF_ARGS="format=nv12|vaapi,hwupload"
VIDEO_CODEC=h264_vaapi
VIDEO_CRF=35
VIDEO_PRESET=medium

# Logging
# Set LOG_FILE to enable file logging (in addition to stdout)
# Leave empty or remove to log only to stdout
LOG_FILE=/logs/app.log

# ============================================
# Security Configuration
# ============================================

# SECRET_KEY is required for session security
# Generate with: python -c "import secrets; print(secrets.token_hex(32))"
SECRET_KEY=your-secure-random-key-here

# User Authentication
# Add users as user1/pass1, user2/pass2, etc.
# For production, use bcrypt hashed passwords:
#   python -c "import bcrypt; print(bcrypt.hashpw(b'yourpassword', bcrypt.gensalt()).decode())"
user1=changeme
pass1=changeme

# ============================================
# go2rtc Live Streaming (WebRTC)
# ============================================

# Timezone for go2rtc container
TZ=Asia/Kolkata

# go2rtc ports (optional, defaults shown)
GO2RTC_API_PORT=2127
GO2RTC_WEBRTC_PORT=8555
GO2RTC_RTSP_PORT=8554

# go2rtc.yaml is AUTO-GENERATED from this .env file
# Run: ./scripts/generate-go2rtc-config.sh

# ============================================
# YouTube Live Streaming (via go2rtc)
# ============================================
# Each channel gets its own stream key (1:1 mapping)
# Stream restarts hourly to create separate YouTube videos for easy archiving
# Create keys at: YouTube Studio -> Create -> Go Live -> Stream

YOUTUBE_LIVE_ENABLED=false
YOUTUBE_RTMP_URL=rtmp://a.rtmp.youtube.com/live2
YOUTUBE_GRID=4
YOUTUBE_LIVE_RESTART_INTERVAL_HOURS=10
YOUTUBE_LIVE_RESTART_DELAY_SECONDS=120

# Hardware Acceleration for YouTube Streaming (reduces CPU by 60-80%)
# Set to true to use VAAPI (Intel GPU) for encoding instead of libx264
YOUTUBE_STREAM_HW_ACCEL=true
YOUTUBE_STREAM_HW_DEVICE=/dev/dri/renderD128

# Stream keys: one per channel (only configure the channels you want to stream)
# Get keys from: YouTube Studio -> Create -> Go Live -> Stream settings
YOUTUBE_STREAM_KEY_1=
YOUTUBE_STREAM_KEY_2=
YOUTUBE_STREAM_KEY_3=
YOUTUBE_STREAM_KEY_4=
YOUTUBE_STREAM_KEY_5=
YOUTUBE_STREAM_KEY_6=
YOUTUBE_STREAM_KEY_7=
YOUTUBE_STREAM_KEY_8=

# ============================================
# YouTube Video Upload (Recorded Videos)
# ============================================
# Requires: client_secret.json from Google Cloud Console

YOUTUBE_UPLOAD_ENABLED=true
YOUTUBE_UPLOAD_BATCH_SIZE_MB=100

# YouTube Account 1 (place client secrets in ./client/ folder)
YOUTUBE_CLIENT_SECRET_PATH_1=client/ytktclient_secret.json
YOUTUBE_TOKEN_PATH_1=ytkttoken.json
GOOGLE_EMAIL_1=user1@gmail.com
GOOGLE_PASSWORD_1=password1

# YouTube Account 2 (optional, add more as needed)
YOUTUBE_CLIENT_SECRET_PATH_2=client/ytakclient_secret.json
YOUTUBE_TOKEN_PATH_2=ytaktoken.json
GOOGLE_EMAIL_2=user2@gmail.com
GOOGLE_PASSWORD_2=password2

YOUTUBE_ENCRYPT_PATH=./encrypt
YOUTUBE_VIDEO_PRIVACY=private
YOUTUBE_DELETE_AFTER_UPLOAD=false
YOUTUBE_UPLOAD_INTERVAL=3600

HF_REPO_ID=changeme
YT_ENCRYP_KEY=changeme
HF_TOKEN=changeme


# ============================================
# Cloudflare Tunnel (Remote Access)
# ============================================
# Set up secure remote access via Cloudflare Tunnel
# Run: ./scripts/setup_cloudflare_tunnel.sh

CF_TUNNEL_NAME=cctv
CF_TUNNEL_DOMAIN=cctv.voidall.com

# ============================================
# SSH Configuration for Docker-to-Host Auth
# ============================================
# When the uploader (running in Docker) needs to re-authenticate,
# it SSHs to the host machine to run scripts/reauth.py
# Run: ./scripts/setup-ssh-auth.sh to configure SSH keys

SSH_HOST_USER=jebin
PROJECT_DIR=/home/jebin/git/Mini-NVR


GOOGLE_CLIENT_ID=changeme
JWT_SECRET=changeme
VITE_API_BASE_URL=/api
